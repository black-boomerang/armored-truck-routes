# Модель по построению оптимальных маршрутов инкассации платежных терминалов

## Структура репозитоия
* `configs` файлы конфигурации с указанием путей до входных данных, параметрами модели и бизнес ограничениями
* `notebooks` ноутбуки с визуализацией данных и демонстрация работы алгоритмов
  - data_analysis анализ данных
  - density_analysis подбор параметров и визуализация Density Solver (с учётом всех улучшений)
  - stp_clustering анализ алгоритма кластеризации STP
* `reports` отчеты, которые получаются в результате работы алгоритма
* `src` исходный код
  - `clustering` STPClustering алгоритм
  - `report` файлы для генерации отчета
  - `solvers` DensitySolver и STPClustering солверы
  - `task` Класс для задания бизнес ограничений
  - `tools` Вычисление итоговых метрик
  - `utils` Настройка конфигураций, работа с данными, построение маршрутов и визуализация
* `main.py` запуск алгоритма построения маршрутов

## Описание решения

### Решение 1 (Spanning Tree Pruning Clustering Algorithm)

1. Строим минимальное остовное дерево (алгоритм Прима) для выбранных точек
2. Выполняем pruning дерева — отрезаем поддерево наибольшего веса, не превышающего заданного
3. Повторяем пункты 1-2 пока множество точек не пусто
 
### Решение 2 (Density Algorithm)

Идея: оцениваем плотность каждого терминала на основе его загруженности, дней после последнего обслуживания и плотности соседей (с учётом времени до них).

В начале каждого дня отбираем n% "наиболее важных" терминалов, в которые включаем:
1. переполненные терминалы (те терминалы, у которых превышен максимальный лимит)
2. добранные до n% на основе количества дней до дедлайна

Далее для каждого броневика:
1. Оцениваем "стартовую плотность" каждого терминала;
2. Оцениваем "плотность" терминала на основе стартовой плотности всех терминалов и времени до них;
3. Выбираем терминал с самой высокой плотностью;
4. Образуем из ближайших терминалов кластер, который может объехать 1 броневик (бинарный поиск + TSP);
5. Выкидываем все терминалы, не попавшие в кластер, из рассмотрения для последующих броневиков.
